{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///E:/Projects/v0-cantina-memeber-ship-admin-panel-main/lib/api/client.ts"],"sourcesContent":["export interface ApiResponse<T> {\n    success: boolean\n    data?: T\n    message?: string\n    error?: string\n}\n\nexport interface RequestOptions extends RequestInit {\n    params?: Record<string, string | number | boolean>\n}\n\nclass ApiClient {\n    private baseURL: string\n\n    constructor(baseURL?: string) {\n        // Use environment variable or default to your API endpoint\n        this.baseURL = baseURL || process.env.NEXT_PUBLIC_API_URL || 'https://mjzctqcx-3000.asse.devtunnels.ms'\n    }\n\n\n    private getToken(): string | null {\n        if (typeof window === 'undefined') return null\n        return localStorage.getItem('authToken')\n    }\n\n\n    private buildURL(endpoint: string, params?: Record<string, string | number | boolean>): string {\n        const url = new URL(endpoint, this.baseURL)\n\n        if (params) {\n            Object.entries(params).forEach(([key, value]) => {\n                url.searchParams.append(key, String(value))\n            })\n        }\n\n        return url.toString()\n    }\n\n\n    private async handleResponse<T>(response: Response): Promise<ApiResponse<T>> {\n        const contentType = response.headers.get('content-type')\n        const isJson = contentType?.includes('application/json')\n\n        let data: any\n        try {\n            data = isJson ? await response.json() : await response.text()\n            console.log('[API Client] Response data:', data)\n        } catch (error) {\n            console.error('[API Client] Failed to parse response:', error)\n            throw new Error('Failed to parse response')\n        }\n\n        if (!response.ok) {\n            // Handle tRPC error format\n            let errorMessage: string\n            if (isJson && data?.error) {\n                // tRPC error format: { error: { message, code, data } }\n                errorMessage = typeof data.error === 'string' \n                    ? data.error \n                    : data.error?.message || 'An error occurred'\n            } else if (isJson && data?.message) {\n                errorMessage = typeof data.message === 'string' ? data.message : 'An error occurred'\n            } else {\n                errorMessage = typeof data === 'string' ? data : `HTTP error! status: ${response.status}`\n            }\n\n            return {\n                success: false,\n                error: errorMessage,\n                message: errorMessage,\n            }\n        }\n\n        // Handle tRPC success response format\n        // tRPC returns: { result: { data: {...} } } or { result: { data: { users: [], pagination: {} } } }\n        let responseData = data\n        if (isJson && data?.result?.data) {\n            // tRPC format: { result: { data: {...} } }\n            responseData = data.result.data\n        } else if (isJson && data?.data) {\n            // Direct data format\n            responseData = data.data\n        } else if (isJson && Array.isArray(data)) {\n            // Array response\n            responseData = data\n        }\n\n        console.log('[API Client] Extracted response data:', responseData)\n\n        return {\n            success: true,\n            data: responseData as T,\n            ...(isJson && data.message && { message: typeof data.message === 'string' ? data.message : undefined }),\n        }\n    }\n\n\n    private async request<T>(\n        endpoint: string,\n        options: RequestOptions = {}\n    ): Promise<ApiResponse<T>> {\n        const { params, headers = {}, ...fetchOptions } = options\n\n        const url = this.buildURL(endpoint, params)\n        const token = this.getToken()\n\n        const defaultHeaders: HeadersInit = {\n            'Content-Type': 'application/json',\n            ...(token && { Authorization: `Bearer ${token}` }),\n            ...headers,\n        }\n\n        try {\n            console.log('[API Client] Making request to:', url)\n            console.log('[API Client] Request body:', fetchOptions.body)\n            console.log('[API Client] Request headers:', defaultHeaders)\n            \n            const response = await fetch(url, {\n                ...fetchOptions,\n                headers: defaultHeaders,\n            })\n\n            console.log('[API Client] Response status:', response.status)\n            console.log('[API Client] Response ok:', response.ok)\n            \n            return this.handleResponse<T>(response)\n        } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Network error occurred'\n            return {\n                success: false,\n                error: errorMessage,\n                message: errorMessage,\n            }\n        }\n    }\n\n\n    async get<T>(endpoint: string, options?: RequestOptions): Promise<ApiResponse<T>> {\n        return this.request<T>(endpoint, {\n            ...options,\n            method: 'GET',\n        })\n    }\n\n\n    async post<T>(endpoint: string, data?: any, options?: RequestOptions): Promise<ApiResponse<T>> {\n        return this.request<T>(endpoint, {\n            ...options,\n            method: 'POST',\n            body: data ? JSON.stringify(data) : undefined,\n        })\n    }\n\n\n    async put<T>(endpoint: string, data?: any, options?: RequestOptions): Promise<ApiResponse<T>> {\n        return this.request<T>(endpoint, {\n            ...options,\n            method: 'PUT',\n            body: data ? JSON.stringify(data) : undefined,\n        })\n    }\n\n\n    async patch<T>(endpoint: string, data?: any, options?: RequestOptions): Promise<ApiResponse<T>> {\n        return this.request<T>(endpoint, {\n            ...options,\n            method: 'PATCH',\n            body: data ? JSON.stringify(data) : undefined,\n        })\n    }\n\n\n    async delete<T>(endpoint: string, options?: RequestOptions): Promise<ApiResponse<T>> {\n        return this.request<T>(endpoint, {\n            ...options,\n            method: 'DELETE',\n        })\n    }\n}\n\n// Export singleton instance\nexport const apiClient = new ApiClient()"],"names":[],"mappings":"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"}},
    {"offset": {"line": 172, "column": 0}, "map": {"version":3,"sources":["file:///E:/Projects/v0-cantina-memeber-ship-admin-panel-main/lib/api/auth.ts"],"sourcesContent":["\n\nimport { apiClient } from './client'\nimport type { LoginRequest, LoginResponse, User } from '../types/auth'\n\nclass AuthService {\n\n  async login(credentials: LoginRequest): Promise<LoginResponse> {\n    try {\n      // tRPC endpoint format: /api/trpc/[procedure]\n      // Try direct JSON format first (most common tRPC format)\n      console.log('[Auth Service] Calling login API with:', credentials)\n      const response = await apiClient.post<LoginResponse['data']>('/api/trpc/admin.auth.login', credentials)\n      console.log('[Auth Service] API Response:', response)\n      \n      if (response.success && response.data) {\n        // Handle tRPC response - data might be nested\n        const loginData = response.data as any\n        \n        // Extract token and user from response\n        // Adjust these based on your actual API response structure\n        const token = loginData.token || loginData.accessToken || loginData.access_token\n        const user = loginData.user || loginData\n        \n        if (token && user && typeof window !== 'undefined') {\n          localStorage.setItem('authToken', token)\n          localStorage.setItem(\n            'adminUser',\n            JSON.stringify({\n              id: user.id || user._id || '',\n              email: user.email || credentials.email,\n              role: user.role || 'admin',\n              name: user.name || user.username || '',\n            })\n          )\n          \n          if (loginData.expiresIn) {\n            const expirationTime = Date.now() + loginData.expiresIn * 1000\n            localStorage.setItem('tokenExpiration', expirationTime.toString())  \n          }\n        }\n\n        return {\n          success: true,\n          data: {\n            token: token || '',\n            user: {\n              id: user.id || user._id || '',\n              email: user.email || credentials.email,\n              role: user.role || 'admin',\n              name: user.name || user.username,\n            },\n            expiresIn: loginData.expiresIn,\n          },\n          message: 'Login successful',\n        }\n      }\n\n      // Extract error message properly\n      const errorMsg = typeof response.error === 'string' \n        ? response.error \n        : typeof response.error === 'object' && (response.error as any)?.message\n        ? (response.error as any).message\n        : typeof response.message === 'string'\n        ? response.message\n        : 'Login failed'\n\n      return {\n        success: false,\n        error: errorMsg,\n        message: errorMsg,\n      }\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'An unexpected error occurred'\n      return {\n        success: false,\n        error: errorMessage,\n        message: errorMessage,\n      }\n    }\n  }\n\n  logout(): void {\n    if (typeof window !== 'undefined') {\n      localStorage.removeItem('authToken')\n      localStorage.removeItem('adminUser')\n      localStorage.removeItem('tokenExpiration')\n    }\n  }\n\n  /**\n   * Get current user from storage\n   */\n  getCurrentUser(): User | null {\n    if (typeof window === 'undefined') return null\n    \n    const userStr = localStorage.getItem('adminUser')\n    if (!userStr) return null\n\n    try {\n      return JSON.parse(userStr) as User\n    } catch {\n      return null\n    }\n  }\n\n  /**\n   * Get auth token from storage\n   */\n  getToken(): string | null {\n    if (typeof window === 'undefined') return null\n    return localStorage.getItem('authToken')\n  }\n\n  /**\n   * Check if token is expired\n   */\n  isTokenExpired(): boolean {\n    if (typeof window === 'undefined') return true\n    \n    const expiration = localStorage.getItem('tokenExpiration')\n    if (!expiration) return false // No expiration set, assume valid\n    \n    return Date.now() > parseInt(expiration, 10)\n  }\n\n  /**\n   * Verify token with backend (optional - for token validation)\n   */\n  async verifyToken(): Promise<boolean> {\n    try {\n      const response = await apiClient.get<{ valid: boolean }>('/auth/verify')\n      return response.success && response.data?.valid === true\n    } catch {\n      return false\n    }\n  }\n}\n\n// Export singleton instance\nexport const authService = new AuthService()"],"names":[],"mappings":";;;;AAEA;;AAGA,MAAM;IAEJ,MAAM,MAAM,WAAyB,EAA0B;QAC7D,IAAI;YACF,8CAA8C;YAC9C,yDAAyD;YACzD,QAAQ,GAAG,CAAC,0CAA0C;YACtD,MAAM,WAAW,MAAM,iIAAS,CAAC,IAAI,CAAwB,8BAA8B;YAC3F,QAAQ,GAAG,CAAC,gCAAgC;YAE5C,IAAI,SAAS,OAAO,IAAI,SAAS,IAAI,EAAE;gBACrC,8CAA8C;gBAC9C,MAAM,YAAY,SAAS,IAAI;gBAE/B,uCAAuC;gBACvC,2DAA2D;gBAC3D,MAAM,QAAQ,UAAU,KAAK,IAAI,UAAU,WAAW,IAAI,UAAU,YAAY;gBAChF,MAAM,OAAO,UAAU,IAAI,IAAI;gBAE/B;;gBAkBA,OAAO;oBACL,SAAS;oBACT,MAAM;wBACJ,OAAO,SAAS;wBAChB,MAAM;4BACJ,IAAI,KAAK,EAAE,IAAI,KAAK,GAAG,IAAI;4BAC3B,OAAO,KAAK,KAAK,IAAI,YAAY,KAAK;4BACtC,MAAM,KAAK,IAAI,IAAI;4BACnB,MAAM,KAAK,IAAI,IAAI,KAAK,QAAQ;wBAClC;wBACA,WAAW,UAAU,SAAS;oBAChC;oBACA,SAAS;gBACX;YACF;YAEA,iCAAiC;YACjC,MAAM,WAAW,OAAO,SAAS,KAAK,KAAK,WACvC,SAAS,KAAK,GACd,OAAO,SAAS,KAAK,KAAK,YAAa,SAAS,KAAK,EAAU,UAC/D,AAAC,SAAS,KAAK,CAAS,OAAO,GAC/B,OAAO,SAAS,OAAO,KAAK,WAC5B,SAAS,OAAO,GAChB;YAEJ,OAAO;gBACL,SAAS;gBACT,OAAO;gBACP,SAAS;YACX;QACF,EAAE,OAAO,OAAO;YACd,MAAM,eAAe,iBAAiB,QAAQ,MAAM,OAAO,GAAG;YAC9D,OAAO;gBACL,SAAS;gBACT,OAAO;gBACP,SAAS;YACX;QACF;IACF;IAEA,SAAe;QACb;;IAKF;IAEA;;GAEC,GACD,iBAA8B;QAC5B,wCAAmC,OAAO;;;QAE1C,MAAM;IAQR;IAEA;;GAEC,GACD,WAA0B;QACxB,wCAAmC,OAAO;;;IAE5C;IAEA;;GAEC,GACD,iBAA0B;QACxB,wCAAmC,OAAO;;;QAE1C,MAAM;IAIR;IAEA;;GAEC,GACD,MAAM,cAAgC;QACpC,IAAI;YACF,MAAM,WAAW,MAAM,iIAAS,CAAC,GAAG,CAAqB;YACzD,OAAO,SAAS,OAAO,IAAI,SAAS,IAAI,EAAE,UAAU;QACtD,EAAE,OAAM;YACN,OAAO;QACT;IACF;AACF;AAGO,MAAM,cAAc,IAAI"}},
    {"offset": {"line": 269, "column": 0}, "map": {"version":3,"sources":["file:///E:/Projects/v0-cantina-memeber-ship-admin-panel-main/components/auth-context.tsx"],"sourcesContent":["\"use client\"\n\nimport type React from \"react\"\n\nimport { createContext, useContext, useEffect, useState } from \"react\"\nimport { useRouter, usePathname } from \"next/navigation\"\nimport { authService } from \"@/lib/api/auth\"\nimport type { User } from \"@/lib/types/auth\"\n\ninterface AuthContextType {\n  isAuthenticated: boolean\n  adminUser: { email: string; role: string } | null\n  logout: () => void\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined)\n\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\n  const [isAuthenticated, setIsAuthenticated] = useState(false)\n\n  const [adminUser, setAdminUser] = useState<User | null>(null)\n  const [isChecking, setIsChecking] = useState(true)\n  const router = useRouter()\n  const pathname = usePathname()\n\n  useEffect(() => {\n    const checkAuth = async () => {\n      const token = authService.getToken()\n      const user = authService.getCurrentUser()\n\n      if (token && user && !authService.isTokenExpired()) {\n        setAdminUser(user)\n        setIsAuthenticated(true)\n      } else {\n        if (authService.isTokenExpired()) {\n          authService.logout()\n        }\n        setIsAuthenticated(false)\n        setAdminUser(null)\n        \n        if (!pathname?.includes(\"/login\")) {\n          router.push(\"/login\")\n        }\n      }\n      \n      setIsChecking(false)\n    }\n\n    checkAuth()\n  }, [pathname, router])\n\n  const logout = () => {\n    authService.logout()\n    setIsAuthenticated(false)\n    setAdminUser(null)\n    router.push(\"/login\")\n  }\n\n  if (isChecking) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <div className=\"animate-pulse text-muted-foreground\">Loading...</div>\n      </div>\n    )\n  }\n\n  return <AuthContext.Provider value={{ isAuthenticated, adminUser, logout }}>{children}</AuthContext.Provider>\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext)\n  if (!context) {\n    throw new Error(\"useAuth must be used within AuthProvider\")\n  }\n  return context\n}\n"],"names":[],"mappings":";;;;;;;AAIA;AACA;AACA;AANA;;;;;AAeA,MAAM,4BAAc,IAAA,sNAAa,EAA8B;AAExD,SAAS,aAAa,EAAE,QAAQ,EAAiC;IACtE,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,iNAAQ,EAAC;IAEvD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAc;IACxD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAC7C,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,WAAW,IAAA,iJAAW;IAE5B,IAAA,kNAAS,EAAC;QACR,MAAM,YAAY;YAChB,MAAM,QAAQ,iIAAW,CAAC,QAAQ;YAClC,MAAM,OAAO,iIAAW,CAAC,cAAc;YAEvC,IAAI,SAAS,QAAQ,CAAC,iIAAW,CAAC,cAAc,IAAI;gBAClD,aAAa;gBACb,mBAAmB;YACrB,OAAO;gBACL,IAAI,iIAAW,CAAC,cAAc,IAAI;oBAChC,iIAAW,CAAC,MAAM;gBACpB;gBACA,mBAAmB;gBACnB,aAAa;gBAEb,IAAI,CAAC,UAAU,SAAS,WAAW;oBACjC,OAAO,IAAI,CAAC;gBACd;YACF;YAEA,cAAc;QAChB;QAEA;IACF,GAAG;QAAC;QAAU;KAAO;IAErB,MAAM,SAAS;QACb,iIAAW,CAAC,MAAM;QAClB,mBAAmB;QACnB,aAAa;QACb,OAAO,IAAI,CAAC;IACd;IAEA,IAAI,YAAY;QACd,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;0BAAsC;;;;;;;;;;;IAG3D;IAEA,qBAAO,8OAAC,YAAY,QAAQ;QAAC,OAAO;YAAE;YAAiB;YAAW;QAAO;kBAAI;;;;;;AAC/E;AAEO,SAAS;IACd,MAAM,UAAU,IAAA,mNAAU,EAAC;IAC3B,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT"}}]
}